{"ast":null,"code":"/**\n * Angular Component Base Module\n */\nimport { getValue, isUndefined, setValue, isNullOrUndefined, attributes, createElement } from '@syncfusion/ej2-base';\nimport { EventEmitter } from '@angular/core';\nimport { clearTemplate, registerEvents } from './util';\nvar SVG_REG = /^svg|^path|^g/;\n\nvar ComponentBase =\n/** @class */\nfunction () {\n  function ComponentBase() {\n    this.isProtectedOnChange = true;\n    this.isFormInit = true;\n  }\n\n  ComponentBase.prototype.saveChanges = function (key, newValue, oldValue) {\n    if (this.isProtectedOnChange) {\n      return;\n    }\n\n    this.oldProperties[key] = oldValue;\n    this.changedProperties[key] = newValue;\n    this.finalUpdate(); // tslint:disable-next-line:no-any\n\n    var changeTime = setTimeout(this.dataBind.bind(this));\n\n    var clearUpdate = function clearUpdate() {\n      clearTimeout(changeTime);\n    };\n\n    this.finalUpdate = clearUpdate;\n  };\n\n  ; // tslint:disable-next-line:no-any\n\n  ComponentBase.prototype.ngOnInit = function (isTempRef) {\n    // tslint:disable-next-line:no-any\n    var tempOnThis = isTempRef || this;\n    tempOnThis.registeredTemplate = {};\n    tempOnThis.ngBoundedEvents = {};\n    tempOnThis.isAngular = true;\n    tempOnThis.isFormInit = true;\n    /* istanbul ignore next */\n\n    if (isTempRef) {\n      this.tags = isTempRef.tags;\n    }\n\n    tempOnThis.tags = this.tags || [];\n    tempOnThis.complexTemplate = this.complexTemplate || [];\n    tempOnThis.tagObjects = [];\n    tempOnThis.ngAttr = this.getAngularAttr(tempOnThis.element);\n    /* istanbul ignore next */\n\n    tempOnThis.createElement = function (tagName, prop) {\n      //tslint:disable-next-line\n      var ele = tempOnThis.srenderer ? tempOnThis.srenderer.createElement(tagName) : createElement(tagName);\n\n      if (typeof prop === 'undefined') {\n        return ele;\n      }\n\n      ele.innerHTML = prop.innerHTML ? prop.innerHTML : '';\n\n      if (prop.className !== undefined) {\n        ele.className = prop.className;\n      }\n\n      if (prop.id !== undefined) {\n        ele.id = prop.id;\n      }\n\n      if (prop.styles !== undefined) {\n        ele.setAttribute('style', prop.styles);\n      }\n\n      if (tempOnThis.ngAttr !== undefined) {\n        ele.setAttribute(tempOnThis.ngAttr, '');\n      }\n\n      if (prop.attrs !== undefined) {\n        attributes(ele, prop.attrs);\n      }\n\n      return ele;\n    };\n\n    for (var _i = 0, _a = tempOnThis.tags; _i < _a.length; _i++) {\n      var tag = _a[_i];\n      var tagObject = {\n        instance: getValue('child' + tag.substring(0, 1).toUpperCase() + tag.substring(1), tempOnThis),\n        name: tag\n      };\n      tempOnThis.tagObjects.push(tagObject);\n    }\n\n    var complexTemplates = Object.keys(tempOnThis);\n    complexTemplates = complexTemplates.filter(function (val) {\n      return /Ref$/i.test(val) && /\\_/i.test(val);\n    });\n\n    for (var _b = 0, complexTemplates_1 = complexTemplates; _b < complexTemplates_1.length; _b++) {\n      var tempName = complexTemplates_1[_b];\n      var propName = tempName.replace('Ref', '');\n      var val = {};\n      setValue(propName.replace('_', '.'), getValue(propName, tempOnThis), val);\n      tempOnThis.setProperties(val, true);\n    }\n  };\n\n  ComponentBase.prototype.getAngularAttr = function (ele) {\n    var attributes = ele.attributes;\n    var length = attributes.length;\n    var ngAr;\n\n    for (var i = 0; i < length; i++) {\n      /* istanbul ignore next */\n      if (/_ngcontent/g.test(attributes[i].name)) {\n        ngAr = attributes[i].name;\n      }\n    }\n\n    return ngAr;\n  };\n\n  ; // tslint:disable-next-line:no-any\n\n  ComponentBase.prototype.ngAfterViewInit = function (isTempRef) {\n    // tslint:disable-next-line:no-any\n    var tempAfterViewThis = isTempRef || this;\n    var regExp = /ejs-tab|ejs-accordion/g;\n    /* istanbul ignore next */\n\n    if (regExp.test(tempAfterViewThis.ngEle.nativeElement.outerHTML)) {\n      tempAfterViewThis.ngEle.nativeElement.style.visibility = 'hidden';\n    }\n    /**\n     * Root level template properties are not getting rendered,\n     * Due to ngonchanges not get triggered.\n     * so that we have set template value for root level template properties,\n     * for example: refer below syntax\n     * ```html\n     * <ejs-grid>\n     * <e-column></e-column>\n     * <ng-template #editSettingsTemplate></ng-template>\n     * </ejs-grid>\n     * ```\n     */\n\n\n    var templateProperties = Object.keys(tempAfterViewThis);\n    templateProperties = templateProperties.filter(function (val) {\n      return /Ref$/i.test(val);\n    });\n\n    for (var _i = 0, templateProperties_1 = templateProperties; _i < templateProperties_1.length; _i++) {\n      var tempName = templateProperties_1[_i];\n      var propName = tempName.replace('Ref', '');\n      setValue(propName.replace('_', '.'), getValue(propName + 'Ref', tempAfterViewThis), tempAfterViewThis);\n    } // Used setTimeout for template binding\n    // Refer Link: https://github.com/angular/angular/issues/6005\n\n\n    setTimeout(function () {\n      /* istanbul ignore else  */\n      if (typeof window !== 'undefined' && document.body.contains(tempAfterViewThis.element)) {\n        tempAfterViewThis.appendTo(tempAfterViewThis.element);\n        tempAfterViewThis.ngEle.nativeElement.style.visibility = '';\n      }\n    });\n  }; // tslint:disable-next-line:no-any\n\n\n  ComponentBase.prototype.ngOnDestroy = function (isTempRef) {\n    // tslint:disable-next-line:no-any\n    var tempOnDestroyThis = isTempRef || this;\n    /* istanbul ignore else  */\n\n    setTimeout(function () {\n      if (typeof window !== 'undefined' && tempOnDestroyThis.element.classList.contains('e-control')) {\n        tempOnDestroyThis.destroy();\n        tempOnDestroyThis.clearTemplate(null); // removing bounded events and tagobjects from component after destroy\n\n        tempOnDestroyThis.ngBoundedEvents = {};\n        tempOnDestroyThis.tagObjects = {};\n        tempOnDestroyThis.ngEle = null;\n      }\n    });\n  }; //tslint:disable-next-line\n\n\n  ComponentBase.prototype.clearTemplate = function (templateNames, index) {\n    clearTemplate(this, templateNames, index);\n  };\n\n  ; // tslint:disable-next-line:no-any\n\n  ComponentBase.prototype.ngAfterContentChecked = function (isTempRef) {\n    // tslint:disable-next-line:no-any\n    var tempAfterContentThis = isTempRef || this;\n\n    for (var _i = 0, _a = tempAfterContentThis.tagObjects; _i < _a.length; _i++) {\n      var tagObject = _a[_i];\n\n      if (!isUndefined(tagObject.instance) && (tagObject.instance.isInitChanges || tagObject.instance.hasChanges || tagObject.instance.hasNewChildren)) {\n        if (tagObject.instance.isInitChanges) {\n          var propObj = {}; // For angular 9 compatibility\n          // Not able to get complex directive properties reference ni Onint hook\n          // So we have constructed property here and used\n\n          var complexDirProps = void 0;\n          var list = getValue('instance.list', tagObject);\n\n          if (list && list.length) {\n            complexDirProps = list[0].directivePropList;\n          }\n\n          var skip = true;\n\n          if (tempAfterContentThis.getModuleName && tempAfterContentThis.getModuleName() === 'gantt') {\n            skip = false;\n          }\n\n          if (complexDirProps && skip && complexDirProps.indexOf(tagObject.instance.propertyName) === -1) {\n            var compDirPropList = Object.keys(tagObject.instance.list[0].propCollection);\n\n            for (var h = 0; h < tagObject.instance.list.length; h++) {\n              tagObject.instance.list[h].propCollection[tagObject.instance.propertyName] = [];\n              var obj = {};\n\n              for (var k = 0; k < compDirPropList.length; k++) {\n                var complexPropName = compDirPropList[k];\n                obj[complexPropName] = tagObject.instance.list[h].propCollection[complexPropName];\n              }\n\n              for (var i = 0; i < tagObject.instance.list[h].tags.length; i++) {\n                var tag = tagObject.instance.list[h].tags[i];\n                var childObj = getValue('child' + tag.substring(0, 1).toUpperCase() + tag.substring(1), tagObject.instance.list[h]);\n\n                if (childObj) {\n                  var innerchildObj = tagObject.instance.list[h]['child' + tag.substring(0, 1).toUpperCase() + tag.substring(1)];\n\n                  if (innerchildObj) {\n                    for (var j = 0; j < innerchildObj.list.length; j++) {\n                      var innerTag = innerchildObj.list[0].tags[0];\n\n                      if (innerTag) {\n                        var innerchildTag = getValue('child' + innerTag.substring(0, 1).toUpperCase() + innerTag.substring(1), innerchildObj.list[j]);\n\n                        if (innerchildTag) {\n                          innerchildObj.list[j].tagObjects.push({\n                            instance: innerchildTag,\n                            name: innerTag\n                          });\n                        }\n                      }\n                    }\n                  }\n\n                  tagObject.instance.list[h].tagObjects.push({\n                    instance: childObj,\n                    name: tag\n                  });\n                }\n              }\n\n              tagObject.instance.list[h].propCollection[tagObject.instance.propertyName].push(obj);\n            }\n          } // End angular 9 compatibility\n\n\n          propObj[tagObject.name] = tagObject.instance.getProperties();\n          tempAfterContentThis.setProperties(propObj, tagObject.instance.isInitChanges);\n        } else {\n          /* istanbul ignore next */\n          if (tempAfterContentThis[tagObject.name].length !== tagObject.instance.list.length || tempAfterContentThis.getModuleName() === 'diagram') {\n            tempAfterContentThis[tagObject.name] = tagObject.instance.list;\n          }\n\n          for (var _b = 0, _c = tagObject.instance.list; _b < _c.length; _b++) {\n            var list = _c[_b];\n            var curIndex = tagObject.instance.list.indexOf(list);\n            var curChild = getValue(tagObject.name, tempAfterContentThis)[curIndex];\n            var complexTemplates = Object.keys(curChild);\n            complexTemplates = complexTemplates.filter(function (val) {\n              return /Ref$/i.test(val);\n            });\n\n            if (curChild.properties && Object.keys(curChild.properties).length !== 0 && /chart/.test(tempAfterContentThis.getModuleName())) {\n              for (var _d = 0, complexTemplates_2 = complexTemplates; _d < complexTemplates_2.length; _d++) {\n                var complexPropName = complexTemplates_2[_d];\n                complexPropName = complexPropName.replace(/Ref/, '');\n                curChild.properties[complexPropName] = !curChild.properties[complexPropName] ? curChild.propCollection[complexPropName] : curChild.properties[complexPropName];\n              }\n            }\n\n            if (!isUndefined(curChild) && !isUndefined(curChild.setProperties)) {\n              if (/diagram|DashboardLayout/.test(tempAfterContentThis.getModuleName())) {\n                curChild.setProperties(list.getProperties(), true);\n              } else {\n                curChild.setProperties(list.getProperties());\n              }\n            }\n\n            list.isUpdated = true;\n          }\n        }\n      }\n    }\n  };\n\n  ComponentBase.prototype.registerEvents = function (eventList) {\n    registerEvents(eventList, this);\n  };\n\n  ComponentBase.prototype.twoWaySetter = function (newVal, prop) {\n    var oldVal = getValue(prop, this.properties);\n\n    if (oldVal === newVal) {\n      return;\n    }\n\n    this.saveChanges(prop, newVal, oldVal);\n    setValue(prop, isNullOrUndefined(newVal) ? null : newVal, this.properties);\n    getValue(prop + 'Change', this).emit(newVal);\n  };\n\n  ComponentBase.prototype.addTwoWay = function (propList) {\n    var _this = this;\n\n    var _loop_1 = function _loop_1(prop) {\n      getValue(prop, this_1);\n      Object.defineProperty(this_1, prop, {\n        get: function get() {\n          return getValue(prop, _this.properties);\n        },\n        set: function set(newVal) {\n          return _this.twoWaySetter(newVal, prop);\n        }\n      });\n      setValue(prop + 'Change', new EventEmitter(), this_1);\n    };\n\n    var this_1 = this;\n\n    for (var _i = 0, propList_1 = propList; _i < propList_1.length; _i++) {\n      var prop = propList_1[_i];\n\n      _loop_1(prop);\n    }\n  };\n\n  ComponentBase.prototype.addEventListener = function (eventName, handler) {\n    var eventObj = getValue(eventName, this);\n\n    if (!isUndefined(eventObj)) {\n      if (!this.ngBoundedEvents[eventName]) {\n        this.ngBoundedEvents[eventName] = new Map();\n      }\n\n      this.ngBoundedEvents[eventName].set(handler, eventObj.subscribe(handler));\n    }\n  };\n\n  ComponentBase.prototype.removeEventListener = function (eventName, handler) {\n    var eventObj = getValue(eventName, this);\n\n    if (!isUndefined(eventObj)) {\n      this.ngBoundedEvents[eventName].get(handler).unsubscribe();\n    }\n  };\n\n  ComponentBase.prototype.trigger = function (eventName, eventArgs, success) {\n    var eventObj = getValue(eventName, this);\n    var prevDetection = this.isProtectedOnChange;\n    this.isProtectedOnChange = false;\n\n    if (eventArgs) {\n      eventArgs.name = eventName;\n    }\n\n    if (!isUndefined(eventObj)) {\n      eventObj.next(eventArgs);\n    }\n\n    var localEventObj = getValue('local' + eventName.charAt(0).toUpperCase() + eventName.slice(1), this);\n\n    if (!isUndefined(localEventObj)) {\n      localEventObj.call(this, eventArgs);\n    }\n\n    this.isProtectedOnChange = prevDetection;\n    /* istanbul ignore else  */\n\n    if (success) {\n      this.preventChange = this.isPreventChange;\n      success.call(this, eventArgs);\n    }\n\n    this.isPreventChange = false;\n  };\n\n  return ComponentBase;\n}();\n\nexport { ComponentBase };","map":{"version":3,"sources":["D:/angularStarter/11-24/syncfusion-mytemplate/template-v1/node_modules/@syncfusion/ej2-angular-base/src/component-base.js"],"names":["getValue","isUndefined","setValue","isNullOrUndefined","attributes","createElement","EventEmitter","clearTemplate","registerEvents","SVG_REG","ComponentBase","isProtectedOnChange","isFormInit","prototype","saveChanges","key","newValue","oldValue","oldProperties","changedProperties","finalUpdate","changeTime","setTimeout","dataBind","bind","clearUpdate","clearTimeout","ngOnInit","isTempRef","tempOnThis","registeredTemplate","ngBoundedEvents","isAngular","tags","complexTemplate","tagObjects","ngAttr","getAngularAttr","element","tagName","prop","ele","srenderer","innerHTML","className","undefined","id","styles","setAttribute","attrs","_i","_a","length","tag","tagObject","instance","substring","toUpperCase","name","push","complexTemplates","Object","keys","filter","val","test","_b","complexTemplates_1","tempName","propName","replace","setProperties","ngAr","i","ngAfterViewInit","tempAfterViewThis","regExp","ngEle","nativeElement","outerHTML","style","visibility","templateProperties","templateProperties_1","window","document","body","contains","appendTo","ngOnDestroy","tempOnDestroyThis","classList","destroy","templateNames","index","ngAfterContentChecked","tempAfterContentThis","isInitChanges","hasChanges","hasNewChildren","propObj","complexDirProps","list","directivePropList","skip","getModuleName","indexOf","propertyName","compDirPropList","propCollection","h","obj","k","complexPropName","childObj","innerchildObj","j","innerTag","innerchildTag","getProperties","_c","curIndex","curChild","properties","_d","complexTemplates_2","isUpdated","eventList","twoWaySetter","newVal","oldVal","emit","addTwoWay","propList","_this","_loop_1","this_1","defineProperty","get","set","propList_1","addEventListener","eventName","handler","eventObj","Map","subscribe","removeEventListener","unsubscribe","trigger","eventArgs","success","prevDetection","next","localEventObj","charAt","slice","call","preventChange","isPreventChange"],"mappings":"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","sourcesContent":["/**\n * Angular Component Base Module\n */\nimport { getValue, isUndefined, setValue, isNullOrUndefined, attributes, createElement } from '@syncfusion/ej2-base';\nimport { EventEmitter } from '@angular/core';\nimport { clearTemplate, registerEvents } from './util';\nvar SVG_REG = /^svg|^path|^g/;\nvar ComponentBase = /** @class */ (function () {\n    function ComponentBase() {\n        this.isProtectedOnChange = true;\n        this.isFormInit = true;\n    }\n    ComponentBase.prototype.saveChanges = function (key, newValue, oldValue) {\n        if (this.isProtectedOnChange) {\n            return;\n        }\n        this.oldProperties[key] = oldValue;\n        this.changedProperties[key] = newValue;\n        this.finalUpdate();\n        // tslint:disable-next-line:no-any\n        var changeTime = setTimeout(this.dataBind.bind(this));\n        var clearUpdate = function () {\n            clearTimeout(changeTime);\n        };\n        this.finalUpdate = clearUpdate;\n    };\n    ;\n    // tslint:disable-next-line:no-any\n    ComponentBase.prototype.ngOnInit = function (isTempRef) {\n        // tslint:disable-next-line:no-any\n        var tempOnThis = isTempRef || this;\n        tempOnThis.registeredTemplate = {};\n        tempOnThis.ngBoundedEvents = {};\n        tempOnThis.isAngular = true;\n        tempOnThis.isFormInit = true;\n        /* istanbul ignore next */\n        if (isTempRef) {\n            this.tags = isTempRef.tags;\n        }\n        tempOnThis.tags = this.tags || [];\n        tempOnThis.complexTemplate = this.complexTemplate || [];\n        tempOnThis.tagObjects = [];\n        tempOnThis.ngAttr = this.getAngularAttr(tempOnThis.element);\n        /* istanbul ignore next */\n        tempOnThis.createElement = function (tagName, prop) {\n            //tslint:disable-next-line\n            var ele = tempOnThis.srenderer ? tempOnThis.srenderer.createElement(tagName) : createElement(tagName);\n            if (typeof (prop) === 'undefined') {\n                return ele;\n            }\n            ele.innerHTML = (prop.innerHTML ? prop.innerHTML : '');\n            if (prop.className !== undefined) {\n                ele.className = prop.className;\n            }\n            if (prop.id !== undefined) {\n                ele.id = prop.id;\n            }\n            if (prop.styles !== undefined) {\n                ele.setAttribute('style', prop.styles);\n            }\n            if (tempOnThis.ngAttr !== undefined) {\n                ele.setAttribute(tempOnThis.ngAttr, '');\n            }\n            if (prop.attrs !== undefined) {\n                attributes(ele, prop.attrs);\n            }\n            return ele;\n        };\n        for (var _i = 0, _a = tempOnThis.tags; _i < _a.length; _i++) {\n            var tag = _a[_i];\n            var tagObject = {\n                instance: getValue('child' + tag.substring(0, 1).toUpperCase() + tag.substring(1), tempOnThis),\n                name: tag\n            };\n            tempOnThis.tagObjects.push(tagObject);\n        }\n        var complexTemplates = Object.keys(tempOnThis);\n        complexTemplates = complexTemplates.filter(function (val) {\n            return /Ref$/i.test(val) && /\\_/i.test(val);\n        });\n        for (var _b = 0, complexTemplates_1 = complexTemplates; _b < complexTemplates_1.length; _b++) {\n            var tempName = complexTemplates_1[_b];\n            var propName = tempName.replace('Ref', '');\n            var val = {};\n            setValue(propName.replace('_', '.'), getValue(propName, tempOnThis), val);\n            tempOnThis.setProperties(val, true);\n        }\n    };\n    ComponentBase.prototype.getAngularAttr = function (ele) {\n        var attributes = ele.attributes;\n        var length = attributes.length;\n        var ngAr;\n        for (var i = 0; i < length; i++) {\n            /* istanbul ignore next */\n            if (/_ngcontent/g.test(attributes[i].name)) {\n                ngAr = attributes[i].name;\n            }\n        }\n        return ngAr;\n    };\n    ;\n    // tslint:disable-next-line:no-any\n    ComponentBase.prototype.ngAfterViewInit = function (isTempRef) {\n        // tslint:disable-next-line:no-any\n        var tempAfterViewThis = isTempRef || this;\n        var regExp = /ejs-tab|ejs-accordion/g;\n        /* istanbul ignore next */\n        if (regExp.test(tempAfterViewThis.ngEle.nativeElement.outerHTML)) {\n            tempAfterViewThis.ngEle.nativeElement.style.visibility = 'hidden';\n        }\n        /**\n         * Root level template properties are not getting rendered,\n         * Due to ngonchanges not get triggered.\n         * so that we have set template value for root level template properties,\n         * for example: refer below syntax\n         * ```html\n         * <ejs-grid>\n         * <e-column></e-column>\n         * <ng-template #editSettingsTemplate></ng-template>\n         * </ejs-grid>\n         * ```\n         */\n        var templateProperties = Object.keys(tempAfterViewThis);\n        templateProperties = templateProperties.filter(function (val) {\n            return /Ref$/i.test(val);\n        });\n        for (var _i = 0, templateProperties_1 = templateProperties; _i < templateProperties_1.length; _i++) {\n            var tempName = templateProperties_1[_i];\n            var propName = tempName.replace('Ref', '');\n            setValue(propName.replace('_', '.'), getValue(propName + 'Ref', tempAfterViewThis), tempAfterViewThis);\n        }\n        // Used setTimeout for template binding\n        // Refer Link: https://github.com/angular/angular/issues/6005\n        setTimeout(function () {\n            /* istanbul ignore else  */\n            if (typeof window !== 'undefined' && document.body.contains(tempAfterViewThis.element)) {\n                tempAfterViewThis.appendTo(tempAfterViewThis.element);\n                tempAfterViewThis.ngEle.nativeElement.style.visibility = '';\n            }\n        });\n    };\n    // tslint:disable-next-line:no-any\n    ComponentBase.prototype.ngOnDestroy = function (isTempRef) {\n        // tslint:disable-next-line:no-any\n        var tempOnDestroyThis = isTempRef || this;\n        /* istanbul ignore else  */\n        setTimeout(function () {\n            if (typeof window !== 'undefined' && (tempOnDestroyThis.element.classList.contains('e-control'))) {\n                tempOnDestroyThis.destroy();\n                tempOnDestroyThis.clearTemplate(null);\n                // removing bounded events and tagobjects from component after destroy\n                tempOnDestroyThis.ngBoundedEvents = {};\n                tempOnDestroyThis.tagObjects = {};\n                tempOnDestroyThis.ngEle = null;\n            }\n        });\n    };\n    //tslint:disable-next-line\n    ComponentBase.prototype.clearTemplate = function (templateNames, index) {\n        clearTemplate(this, templateNames, index);\n    };\n    ;\n    // tslint:disable-next-line:no-any\n    ComponentBase.prototype.ngAfterContentChecked = function (isTempRef) {\n        // tslint:disable-next-line:no-any\n        var tempAfterContentThis = isTempRef || this;\n        for (var _i = 0, _a = tempAfterContentThis.tagObjects; _i < _a.length; _i++) {\n            var tagObject = _a[_i];\n            if (!isUndefined(tagObject.instance) &&\n                (tagObject.instance.isInitChanges || tagObject.instance.hasChanges || tagObject.instance.hasNewChildren)) {\n                if (tagObject.instance.isInitChanges) {\n                    var propObj = {};\n                    // For angular 9 compatibility\n                    // Not able to get complex directive properties reference ni Onint hook\n                    // So we have constructed property here and used\n                    var complexDirProps = void 0;\n                    var list = getValue('instance.list', tagObject);\n                    if (list && list.length) {\n                        complexDirProps = list[0].directivePropList;\n                    }\n                    var skip = true;\n                    if (tempAfterContentThis.getModuleName && tempAfterContentThis.getModuleName() === 'gantt') {\n                        skip = false;\n                    }\n                    if (complexDirProps && skip && complexDirProps.indexOf(tagObject.instance.propertyName) === -1) {\n                        var compDirPropList = Object.keys(tagObject.instance.list[0].propCollection);\n                        for (var h = 0; h < tagObject.instance.list.length; h++) {\n                            tagObject.instance.list[h].propCollection[tagObject.instance.propertyName] = [];\n                            var obj = {};\n                            for (var k = 0; k < compDirPropList.length; k++) {\n                                var complexPropName = compDirPropList[k];\n                                obj[complexPropName] = tagObject.instance.list[h].propCollection[complexPropName];\n                            }\n                            for (var i = 0; i < tagObject.instance.list[h].tags.length; i++) {\n                                var tag = tagObject.instance.list[h].tags[i];\n                                var childObj = getValue('child' + tag.substring(0, 1).toUpperCase() + tag.substring(1), tagObject.instance.list[h]);\n                                if (childObj) {\n                                    var innerchildObj = tagObject.instance.list[h]['child' + tag.substring(0, 1).toUpperCase() + tag.substring(1)];\n                                    if (innerchildObj) {\n                                        for (var j = 0; j < innerchildObj.list.length; j++) {\n                                            var innerTag = innerchildObj.list[0].tags[0];\n                                            if (innerTag) {\n                                                var innerchildTag = getValue('child' + innerTag.substring(0, 1).toUpperCase() + innerTag.substring(1), innerchildObj.list[j]);\n                                                if (innerchildTag) {\n                                                    innerchildObj.list[j].tagObjects.push({ instance: innerchildTag, name: innerTag });\n                                                }\n                                            }\n                                        }\n                                    }\n                                    tagObject.instance.list[h].tagObjects.push({ instance: childObj, name: tag });\n                                }\n                            }\n                            tagObject.instance.list[h].propCollection[tagObject.instance.propertyName].push(obj);\n                        }\n                    }\n                    // End angular 9 compatibility\n                    propObj[tagObject.name] = tagObject.instance.getProperties();\n                    tempAfterContentThis.setProperties(propObj, tagObject.instance.isInitChanges);\n                }\n                else {\n                    /* istanbul ignore next */\n                    if ((tempAfterContentThis[tagObject.name].length !== tagObject.instance.list.length) || (tempAfterContentThis.getModuleName() === 'diagram')) {\n                        tempAfterContentThis[tagObject.name] = tagObject.instance.list;\n                    }\n                    for (var _b = 0, _c = tagObject.instance.list; _b < _c.length; _b++) {\n                        var list = _c[_b];\n                        var curIndex = tagObject.instance.list.indexOf(list);\n                        var curChild = getValue(tagObject.name, tempAfterContentThis)[curIndex];\n                        var complexTemplates = Object.keys(curChild);\n                        complexTemplates = complexTemplates.filter(function (val) {\n                            return /Ref$/i.test(val);\n                        });\n                        if (curChild.properties && Object.keys(curChild.properties).length !== 0 && /chart/.test(tempAfterContentThis.getModuleName())) {\n                            for (var _d = 0, complexTemplates_2 = complexTemplates; _d < complexTemplates_2.length; _d++) {\n                                var complexPropName = complexTemplates_2[_d];\n                                complexPropName = complexPropName.replace(/Ref/, '');\n                                curChild.properties[complexPropName] = !curChild.properties[complexPropName] ?\n                                    curChild.propCollection[complexPropName] : curChild.properties[complexPropName];\n                            }\n                        }\n                        if (!isUndefined(curChild) && !isUndefined(curChild.setProperties)) {\n                            if (/diagram|DashboardLayout/.test(tempAfterContentThis.getModuleName())) {\n                                curChild.setProperties(list.getProperties(), true);\n                            }\n                            else {\n                                curChild.setProperties(list.getProperties());\n                            }\n                        }\n                        list.isUpdated = true;\n                    }\n                }\n            }\n        }\n    };\n    ComponentBase.prototype.registerEvents = function (eventList) {\n        registerEvents(eventList, this);\n    };\n    ComponentBase.prototype.twoWaySetter = function (newVal, prop) {\n        var oldVal = getValue(prop, this.properties);\n        if (oldVal === newVal) {\n            return;\n        }\n        this.saveChanges(prop, newVal, oldVal);\n        setValue(prop, (isNullOrUndefined(newVal) ? null : newVal), this.properties);\n        getValue(prop + 'Change', this).emit(newVal);\n    };\n    ComponentBase.prototype.addTwoWay = function (propList) {\n        var _this = this;\n        var _loop_1 = function (prop) {\n            getValue(prop, this_1);\n            Object.defineProperty(this_1, prop, {\n                get: function () {\n                    return getValue(prop, _this.properties);\n                },\n                set: function (newVal) { return _this.twoWaySetter(newVal, prop); }\n            });\n            setValue(prop + 'Change', new EventEmitter(), this_1);\n        };\n        var this_1 = this;\n        for (var _i = 0, propList_1 = propList; _i < propList_1.length; _i++) {\n            var prop = propList_1[_i];\n            _loop_1(prop);\n        }\n    };\n    ComponentBase.prototype.addEventListener = function (eventName, handler) {\n        var eventObj = getValue(eventName, this);\n        if (!isUndefined(eventObj)) {\n            if (!this.ngBoundedEvents[eventName]) {\n                this.ngBoundedEvents[eventName] = new Map();\n            }\n            this.ngBoundedEvents[eventName].set(handler, eventObj.subscribe(handler));\n        }\n    };\n    ComponentBase.prototype.removeEventListener = function (eventName, handler) {\n        var eventObj = getValue(eventName, this);\n        if (!isUndefined(eventObj)) {\n            this.ngBoundedEvents[eventName].get(handler).unsubscribe();\n        }\n    };\n    ComponentBase.prototype.trigger = function (eventName, eventArgs, success) {\n        var eventObj = getValue(eventName, this);\n        var prevDetection = this.isProtectedOnChange;\n        this.isProtectedOnChange = false;\n        if (eventArgs) {\n            eventArgs.name = eventName;\n        }\n        if (!isUndefined(eventObj)) {\n            eventObj.next(eventArgs);\n        }\n        var localEventObj = getValue('local' + eventName.charAt(0).toUpperCase() + eventName.slice(1), this);\n        if (!isUndefined(localEventObj)) {\n            localEventObj.call(this, eventArgs);\n        }\n        this.isProtectedOnChange = prevDetection;\n        /* istanbul ignore else  */\n        if (success) {\n            this.preventChange = this.isPreventChange;\n            success.call(this, eventArgs);\n        }\n        this.isPreventChange = false;\n    };\n    return ComponentBase;\n}());\nexport { ComponentBase };\n"]},"metadata":{},"sourceType":"module"}